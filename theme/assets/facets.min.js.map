{
  "version": 3,
  "sources": ["../../app/scripts/facets.js"],
  "sourcesContent": ["class FacetFiltersForm extends HTMLElement {\r\n    constructor() {\r\n      super();\r\n      this.onActiveFilterClick = this.onActiveFilterClick.bind(this);\r\n  \r\n      this.debouncedOnSubmit = debounce((event) => {\r\n        this.onSubmitHandler(event);\r\n      }, 500);\r\n  \r\n      const facetForm = this.querySelector('form');\r\n      facetForm.addEventListener('input', this.debouncedOnSubmit.bind(this));\r\n  \r\n    //   const facetWrapper = this.querySelector('#FacetsWrapperDesktop');\r\n    //   if (facetWrapper) facetWrapper.addEventListener('keyup', onKeyUpEscape);\r\n    }\r\n  \r\n    static setListeners() {\r\n      const onHistoryChange = (event) => {\r\n        const searchParams = event.state ? event.state.searchParams : FacetFiltersForm.searchParamsInitial;\r\n        if (searchParams === FacetFiltersForm.searchParamsPrev) return;\r\n        FacetFiltersForm.renderPage(searchParams, null, false);\r\n      }\r\n      window.addEventListener('popstate', onHistoryChange);\r\n    }\r\n  \r\n    static toggleActiveFacets(disable = true) {\r\n      document.querySelectorAll('.js-facet-remove').forEach((element) => {\r\n        element.classList.toggle('disabled', disable);\r\n      });\r\n    }\r\n  \r\n    static renderPage(searchParams, event, updateURLHash = true) {\r\n      FacetFiltersForm.searchParamsPrev = searchParams;\r\n      const sections = FacetFiltersForm.getSections();\r\n    //   const countContainer = document.getElementById('ProductCount');\r\n    //   const countContainerDesktop = document.getElementById('ProductCountDesktop');\r\n    //   document.getElementById('ProductGridContainer').querySelector('.collection').classList.add('loading');\r\n    //   if (countContainer){\r\n    //     countContainer.classList.add('loading');\r\n    //   }\r\n    //   if (countContainerDesktop){\r\n    //     countContainerDesktop.classList.add('loading');\r\n    //   }\r\n  \r\n      sections.forEach((section) => {\r\n        const url = `${window.location.pathname}?section_id=${section.section}&${searchParams}`;\r\n        const filterDataUrl = element => element.url === url;\r\n  \r\n        FacetFiltersForm.filterData.some(filterDataUrl) ?\r\n          FacetFiltersForm.renderSectionFromCache(filterDataUrl, event) :\r\n          FacetFiltersForm.renderSectionFromFetch(url, event);\r\n      });\r\n  \r\n      if (updateURLHash) FacetFiltersForm.updateURLHash(searchParams);\r\n    }\r\n  \r\n    static renderSectionFromFetch(url, event) {\r\n      fetch(url)\r\n        .then(response => response.text())\r\n        .then((responseText) => {\r\n          const html = responseText;\r\n          FacetFiltersForm.filterData = [...FacetFiltersForm.filterData, { html, url }];\r\n          FacetFiltersForm.renderFilters(html, event);\r\n          FacetFiltersForm.renderProductGridContainer(html);\r\n          //FacetFiltersForm.renderProductCount(html);\r\n        });\r\n    }\r\n  \r\n    static renderSectionFromCache(filterDataUrl, event) {\r\n      const html = FacetFiltersForm.filterData.find(filterDataUrl).html;\r\n      FacetFiltersForm.renderFilters(html, event);\r\n      FacetFiltersForm.renderProductGridContainer(html);\r\n      //FacetFiltersForm.renderProductCount(html);\r\n    }\r\n  \r\n    static renderProductGridContainer(html) {\r\n      document.getElementById('ProductGridContainer').innerHTML = new DOMParser().parseFromString(html, 'text/html').getElementById('ProductGridContainer').innerHTML;\r\n    }\r\n  \r\n    static renderProductCount(html) {\r\n      const count = new DOMParser().parseFromString(html, 'text/html').getElementById('ProductCount').innerHTML\r\n      const container = document.getElementById('ProductCount');\r\n      const containerDesktop = document.getElementById('ProductCountDesktop');\r\n      container.innerHTML = count;\r\n      container.classList.remove('loading');\r\n      if (containerDesktop) {\r\n        containerDesktop.innerHTML = count;\r\n        containerDesktop.classList.remove('loading');\r\n      }\r\n    }\r\n  \r\n    static renderFilters(html, event) {\r\n      const parsedHTML = new DOMParser().parseFromString(html, 'text/html');\r\n  \r\n      const facetDetailsElements =\r\n        parsedHTML.querySelectorAll('#FacetFiltersForm .js-filter, #FacetFiltersFormMobile .js-filter, #FacetFiltersPillsForm .js-filter');\r\n      const matchesIndex = (element) => {\r\n        const jsFilter = event ? event.target.closest('.js-filter') : undefined;\r\n        return jsFilter ? element.dataset.index === jsFilter.dataset.index : false;\r\n      }\r\n      const facetsToRender = Array.from(facetDetailsElements).filter(element => !matchesIndex(element));\r\n      //const countsToRender = Array.from(facetDetailsElements).find(matchesIndex);\r\n  \r\n      facetsToRender.forEach((element) => {\r\n        document.querySelector(`.js-filter[data-index=\"${element.dataset.index}\"]`).innerHTML = element.innerHTML;\r\n      });\r\n  \r\n      //FacetFiltersForm.renderActiveFacets(parsedHTML);\r\n      //FacetFiltersForm.renderAdditionalElements(parsedHTML);\r\n  \r\n     // if (countsToRender) FacetFiltersForm.renderCounts(countsToRender, event.target.closest('.js-filter'));\r\n    }\r\n  \r\n    // static renderActiveFacets(html) {\r\n    //   const activeFacetElementSelectors = ['.active-facets-mobile', '.active-facets-desktop'];\r\n  \r\n    //   activeFacetElementSelectors.forEach((selector) => {\r\n    //     const activeFacetsElement = html.querySelector(selector);\r\n    //     if (!activeFacetsElement) return;\r\n    //     document.querySelector(selector).innerHTML = activeFacetsElement.innerHTML;\r\n    //   })\r\n  \r\n    //   FacetFiltersForm.toggleActiveFacets(false);\r\n    // }\r\n  \r\n    // static renderAdditionalElements(html) {\r\n    //   const mobileElementSelectors = ['.mobile-facets__open', '.mobile-facets__count', '.sorting'];\r\n  \r\n    //   mobileElementSelectors.forEach((selector) => {\r\n    //     if (!html.querySelector(selector)) return;\r\n    //     document.querySelector(selector).innerHTML = html.querySelector(selector).innerHTML;\r\n    //   });\r\n  \r\n    //   document.getElementById('FacetFiltersFormMobile').closest('menu-drawer').bindEvents();\r\n    // }\r\n  \r\n    // static renderCounts(source, target) {\r\n    //   const targetElement = target.querySelector('.facets__selected');\r\n    //   const sourceElement = source.querySelector('.facets__selected');\r\n  \r\n    //   const targetElementAccessibility = target.querySelector('.facets__summary');\r\n    //   const sourceElementAccessibility = source.querySelector('.facets__summary');\r\n  \r\n    //   if (sourceElement && targetElement) {\r\n    //     target.querySelector('.facets__selected').outerHTML = source.querySelector('.facets__selected').outerHTML;\r\n    //   }\r\n  \r\n    //   if (targetElementAccessibility && sourceElementAccessibility) {\r\n    //     target.querySelector('.facets__summary').outerHTML = source.querySelector('.facets__summary').outerHTML;\r\n    //   }\r\n    // }\r\n  \r\n    static updateURLHash(searchParams) {\r\n      history.pushState({ searchParams }, '', `${window.location.pathname}${searchParams && '?'.concat(searchParams)}`);\r\n    }\r\n  \r\n    static getSections() {\r\n      return [\r\n        {\r\n          section: document.getElementById('product-grid').dataset.id,\r\n        }\r\n      ]\r\n    }\r\n  \r\n    createSearchParams(form) {\r\n      const formData = new FormData(form);\r\n      return new URLSearchParams(formData).toString();\r\n    }\r\n  \r\n    onSubmitForm(searchParams, event) {\r\n      FacetFiltersForm.renderPage(searchParams, event);\r\n    }\r\n  \r\n    onSubmitHandler(event) {\r\n      event.preventDefault();\r\n      const sortFilterForms = document.querySelectorAll('facet-filters-form form');\r\n      if (event.srcElement.className == 'mobile-facets__checkbox') {\r\n        const searchParams = this.createSearchParams(event.target.closest('form'))\r\n        this.onSubmitForm(searchParams, event)\r\n      } else {\r\n        const forms = [];\r\n        const isMobile = event.target.closest('form').id === 'FacetFiltersFormMobile';\r\n  \r\n        sortFilterForms.forEach((form) => {\r\n          if (!isMobile) {\r\n            if (form.id === 'FacetSortForm' || form.id === 'FacetFiltersForm' || form.id === 'FacetSortDrawerForm') {\r\n              forms.push(this.createSearchParams(form));\r\n            }\r\n          } else if (form.id === 'FacetFiltersFormMobile') {\r\n            forms.push(this.createSearchParams(form));\r\n          }\r\n        });\r\n        this.onSubmitForm(forms.join('&'), event)\r\n      }\r\n    }\r\n  \r\n    onActiveFilterClick(event) {\r\n      event.preventDefault();\r\n      FacetFiltersForm.toggleActiveFacets();\r\n      const url = event.currentTarget.href.indexOf('?') == -1 ? '' : event.currentTarget.href.slice(event.currentTarget.href.indexOf('?') + 1);\r\n      FacetFiltersForm.renderPage(url);\r\n    }\r\n  }\r\n  \r\n  FacetFiltersForm.filterData = [];\r\n  FacetFiltersForm.searchParamsInitial = window.location.search.slice(1);\r\n  FacetFiltersForm.searchParamsPrev = window.location.search.slice(1);\r\n  customElements.define('facet-filters-form', FacetFiltersForm);\r\n  FacetFiltersForm.setListeners();\r\n  \r\n  class PriceRange extends HTMLElement {\r\n    constructor() {\r\n      super();\r\n      this.querySelectorAll('input')\r\n        .forEach(element => element.addEventListener('change', this.onRangeChange.bind(this)));\r\n      this.setMinAndMaxValues();\r\n    }\r\n  \r\n    onRangeChange(event) {\r\n      this.adjustToValidValues(event.currentTarget);\r\n      this.setMinAndMaxValues();\r\n    }\r\n  \r\n    setMinAndMaxValues() {\r\n      const inputs = this.querySelectorAll('input');\r\n      const minInput = inputs[0];\r\n      const maxInput = inputs[1];\r\n      if (maxInput.value) minInput.setAttribute('max', maxInput.value);\r\n      if (minInput.value) maxInput.setAttribute('min', minInput.value);\r\n      if (minInput.value === '') maxInput.setAttribute('min', 0);\r\n      if (maxInput.value === '') minInput.setAttribute('max', maxInput.getAttribute('max'));\r\n    }\r\n  \r\n    adjustToValidValues(input) {\r\n      const value = Number(input.value);\r\n      const min = Number(input.getAttribute('min'));\r\n      const max = Number(input.getAttribute('max'));\r\n  \r\n      if (value < min) input.value = min;\r\n      if (value > max) input.value = max;\r\n    }\r\n  }\r\n  \r\n  customElements.define('price-range', PriceRange);\r\n  \r\n//   class FacetRemove extends HTMLElement {\r\n//     constructor() {\r\n//       super();\r\n//       const facetLink = this.querySelector('a');\r\n//       facetLink.setAttribute('role', 'button');\r\n//       facetLink.addEventListener('click', this.closeFilter.bind(this));\r\n//       facetLink.addEventListener('keyup', (event) => {\r\n//         event.preventDefault();\r\n//         if (event.code.toUpperCase() === 'SPACE') this.closeFilter(event);\r\n//       });\r\n//     }\r\n  \r\n//     closeFilter(event) {\r\n//       event.preventDefault();\r\n//       const form = this.closest('facet-filters-form') || document.querySelector('facet-filters-form');\r\n//       form.onActiveFilterClick(event);\r\n//     }\r\n//   }\r\n  \r\n//   customElements.define('facet-remove', FacetRemove);"],
  "mappings": "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",
  "names": []
}
