(()=>{var r=class extends HTMLElement{constructor(){super();this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.resetQtyInput(),this.toggleAddButton(!0,"",!1),this.currentVariant?(this.updateURL(),this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),t=>t.value)}updateMasterId(){this.currentVariant=this.getVariantData().find(t=>!t.options.map((e,i)=>this.options[i]===e).includes(!1))}resetQtyInput(){let t=document.querySelector("quantity-input .quantity__input");t.value=1}updateURL(){!this.currentVariant||this.dataset.updateUrl==="false"||window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateShareUrl(){let t=document.getElementById(`Share-${this.dataset.section}`);!t||!t.updateUrl||t.updateUrl(`${window.shopUrl}${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}`).forEach(e=>{let i=e.querySelector('input[name="id"]');i.value=this.currentVariant.id,i.dispatchEvent(new Event("change",{bubbles:!0}))})}updatePickupAvailability(){let t=document.querySelector("pickup-availability");!t||(this.currentVariant&&this.currentVariant.available?t.fetchAvailability(this.currentVariant.id):(t.removeAttribute("available"),t.innerHTML=""))}removeErrorMessage(){let t=this.closest("section");if(!t)return;let e=t.querySelector("product-form");e&&e.handleErrorMessage()}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`).then(t=>t.text()).then(t=>{let e=new DOMParser().parseFromString(t,"text/html"),i=document.getElementById(`price-${this.dataset.section}`),n=e.getElementById(`price-${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`),a=document.getElementById(`title-${this.dataset.section}`),s=e.getElementById(`title-${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`),o=document.getElementById(`sku-${this.dataset.section}`),d=e.getElementById(`sku-${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`),c=document.getElementById(`stock-${this.dataset.section}`),u=e.getElementById(`stock-${this.dataset.originalSection?this.dataset.originalSection:this.dataset.section}`);n&&i&&(i.innerHTML=n.innerHTML),s&&a&&(a.innerText=s.innerText),d&&o&&(o.innerText=d.innerText),u&&c&&(c.innerText=u.innerText);let l=document.getElementById(`price-${this.dataset.section}`);l&&l.classList.remove("visibility-hidden"),this.toggleAddButton(!this.currentVariant.available,"Sold out")})}toggleAddButton(t=!0,e,i=!0){let n=document.getElementById(`product-form-${this.dataset.section}`);if(!n)return;let a=n.querySelector('[name="add"]'),s=n.querySelector('[name="add"] .product-form__submit-text');!a||(t?(a.setAttribute("disabled","disabled"),e&&(s.textContent=e)):(a.removeAttribute("disabled"),s.textContent="Add to cart"),!!i)}setUnavailable(){let t=document.getElementById(`product-form-${this.dataset.section}`),e=t.querySelector('[name="add"]'),i=t.querySelector('[name="add"] .product-form__submit-text'),n=document.getElementById(`price-${this.dataset.section}`);!e||(i.textContent="Unavailable",n&&n.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}};customElements.define("variant-selects",r);var h=class extends r{constructor(){super()}updateOptions(){let t=Array.from(this.querySelectorAll("fieldset"));this.options=t.map(e=>Array.from(e.querySelectorAll("input")).find(i=>i.checked).value)}};customElements.define("variant-radios",h);})();
