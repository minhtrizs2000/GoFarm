(()=>{customElements.get("product-form")||customElements.define("product-form",class extends HTMLElement{constructor(){super();this.form=this.querySelector("form"),this.form.querySelector("[name=id]").disabled=!1,this.form.addEventListener("submit",this.onSubmitHandler.bind(this)),this.submitButton=this.querySelector('[type="submit"]')}onSubmitHandler(e){if(e.preventDefault(),this.submitButton.getAttribute("aria-disabled")==="true")return;this.handleErrorMessage(),this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.classList.add("loading"),this.querySelector(".loading-overlay__spinner").classList.remove("hidden");let s=new FormData(this.form),i={method:"POST",body:s};fetch(window.Shopify.routes.root+"cart/add.js",i).then(t=>t.json()).then(t=>{if(t.status){this.handleErrorMessage(t.description);let r=this.submitButton.querySelector(".sold-out-message");if(!r)return;this.submitButton.setAttribute("aria-disabled",!0),this.submitButton.querySelector("span").classList.add("hidden"),r.classList.remove("hidden"),this.error=!0;return}this.error=!1}).catch(t=>{console.error(t)}).finally(()=>{this.submitButton.classList.remove("loading"),this.error||this.submitButton.removeAttribute("aria-disabled"),this.querySelector(".loading-overlay__spinner").classList.add("hidden")})}handleErrorMessage(e=!1){this.errorMessageWrapper=this.errorMessageWrapper||this.querySelector(".product-form__error-message-wrapper"),!!this.errorMessageWrapper&&(this.errorMessage=this.errorMessage||this.errorMessageWrapper.querySelector(".product-form__error-message"),this.errorMessageWrapper.toggleAttribute("hidden",!e),e&&(this.errorMessage.textContent=e))}});})();
