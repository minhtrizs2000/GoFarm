{
  "version": 3,
  "sources": ["../../app/scripts/variant-handle.js"],
  "sourcesContent": ["class VariantSelects extends HTMLElement {\r\n  constructor() {\r\n    super();\r\n    this.addEventListener(\"change\", this.onVariantChange);\r\n  }\r\n\r\n\r\n  onVariantChange() {\r\n    this.updateOptions();\r\n    this.updateMasterId();\r\n    this.resetQtyInput();\r\n    this.toggleAddButton(true, \"\", false);\r\n    //this.updatePickupAvailability();\r\n    //this.removeErrorMessage();\r\n\r\n    if (!this.currentVariant) {\r\n      this.toggleAddButton(true, \"\", true);\r\n      this.setUnavailable();\r\n    } else {\r\n      this.updateURL();\r\n      this.updateVariantInput();\r\n      this.renderProductInfo();\r\n      //this.updateShareUrl();\r\n    }\r\n  }\r\n\r\n  updateOptions() {\r\n    this.options = Array.from(\r\n      this.querySelectorAll(\"select\"),\r\n      (select) => select.value\r\n    );\r\n  }\r\n\r\n  updateMasterId() {\r\n    this.currentVariant = this.getVariantData().find((variant) => {\r\n      return !variant.options\r\n        .map((option, index) => {\r\n          return this.options[index] === option;\r\n        })\r\n        .includes(false);\r\n    });\r\n  }\r\n\r\n  resetQtyInput(){\r\n    const qty = document.querySelector(\"quantity-input .quantity__input\");\r\n    qty.value = 1;\r\n  }\r\n\r\n\r\n  updateURL() {\r\n    if (!this.currentVariant || this.dataset.updateUrl === \"false\") return;\r\n    window.history.replaceState(\r\n      {},\r\n      \"\",\r\n      `${this.dataset.url}?variant=${this.currentVariant.id}`\r\n    );\r\n  }\r\n\r\n  updateShareUrl() {\r\n    const shareButton = document.getElementById(\r\n      `Share-${this.dataset.section}`\r\n    );\r\n    if (!shareButton || !shareButton.updateUrl) return;\r\n    shareButton.updateUrl(\r\n      `${window.shopUrl}${this.dataset.url}?variant=${this.currentVariant.id}`\r\n    );\r\n  }\r\n\r\n  updateVariantInput() {\r\n    const productForms = document.querySelectorAll(`#product-form-${this.dataset.section}`);\r\n    productForms.forEach((productForm) => {\r\n      const input = productForm.querySelector('input[name=\"id\"]');\r\n      input.value = this.currentVariant.id;\r\n      input.dispatchEvent(new Event(\"change\", { bubbles: true }));\r\n    });\r\n  }\r\n\r\n  updatePickupAvailability() {\r\n    const pickUpAvailability = document.querySelector(\"pickup-availability\");\r\n    if (!pickUpAvailability) return;\r\n\r\n    if (this.currentVariant && this.currentVariant.available) {\r\n      pickUpAvailability.fetchAvailability(this.currentVariant.id);\r\n    } else {\r\n      pickUpAvailability.removeAttribute(\"available\");\r\n      pickUpAvailability.innerHTML = \"\";\r\n    }\r\n  }\r\n\r\n  removeErrorMessage() {\r\n    const section = this.closest(\"section\");\r\n    if (!section) return;\r\n\r\n    const productForm = section.querySelector(\"product-form\");\r\n    if (productForm) productForm.handleErrorMessage();\r\n  }\r\n\r\n  renderProductInfo() {\r\n    fetch(\r\n      `${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${\r\n        this.dataset.originalSection\r\n          ? this.dataset.originalSection\r\n          : this.dataset.section\r\n      }`\r\n    )\r\n      .then((response) => response.text())\r\n      .then((responseText) => {\r\n        const html = new DOMParser().parseFromString(responseText, \"text/html\");\r\n        const price_destination = document.getElementById(\r\n          `price-${this.dataset.section}`\r\n        );\r\n        const price_source = html.getElementById(\r\n          `price-${\r\n            this.dataset.originalSection\r\n              ? this.dataset.originalSection\r\n              : this.dataset.section\r\n          }`\r\n        );\r\n        const title_destination = document.getElementById(\r\n          `title-${this.dataset.section}`\r\n        );\r\n        const title_source = html.getElementById(\r\n          `title-${\r\n            this.dataset.originalSection\r\n              ? this.dataset.originalSection\r\n              : this.dataset.section\r\n          }`\r\n        );\r\n        const sku_destination = document.getElementById(\r\n          `sku-${this.dataset.section}`\r\n        );\r\n        const sku_source = html.getElementById(\r\n          `sku-${\r\n            this.dataset.originalSection\r\n              ? this.dataset.originalSection\r\n              : this.dataset.section\r\n          }`\r\n        );\r\n        const stock_destination = document.getElementById(\r\n          `stock-${this.dataset.section}`\r\n        );\r\n        const stock_source = html.getElementById(\r\n          `stock-${\r\n            this.dataset.originalSection\r\n              ? this.dataset.originalSection\r\n              : this.dataset.section\r\n          }`\r\n        );\r\n        \r\n        if (price_source && price_destination) price_destination.innerHTML = price_source.innerHTML;\r\n        if (title_source && title_destination) title_destination.innerText = title_source.innerText;\r\n        if (sku_source && sku_destination) sku_destination.innerText = sku_source.innerText;\r\n        if (stock_source && stock_destination) stock_destination.innerText = stock_source.innerText;\r\n\r\n        const price = document.getElementById(`price-${this.dataset.section}`);\r\n\r\n        if (price) price.classList.remove(\"visibility-hidden\");\r\n        this.toggleAddButton(!this.currentVariant.available, 'Sold out');\r\n      });\r\n  }\r\n\r\n  toggleAddButton(disable = true, text, modifyClass = true) {\r\n    const productForm = document.getElementById(\r\n      `product-form-${this.dataset.section}`\r\n    );\r\n    if (!productForm) return;\r\n    const addButton = productForm.querySelector('[name=\"add\"]');\r\n    const addButtonText = productForm.querySelector('[name=\"add\"] .product-form__submit-text');\r\n    if (!addButton) return;\r\n\r\n    if (disable) {\r\n      addButton.setAttribute(\"disabled\", \"disabled\");\r\n      if (text) addButtonText.textContent = text;\r\n    } else {\r\n      addButton.removeAttribute(\"disabled\");\r\n      addButtonText.textContent = 'Add to cart';\r\n    }\r\n\r\n    if (!modifyClass) return;\r\n  }\r\n\r\n  setUnavailable() {\r\n    const button = document.getElementById(\r\n      `product-form-${this.dataset.section}`\r\n    );\r\n    const addButton = button.querySelector('[name=\"add\"]');\r\n    const addButtonText = button.querySelector('[name=\"add\"] .product-form__submit-text');\r\n    const price = document.getElementById(`price-${this.dataset.section}`);\r\n    if (!addButton) return;\r\n    addButtonText.textContent = 'Unavailable';\r\n    if (price) price.classList.add(\"visibility-hidden\");\r\n  }\r\n\r\n  getVariantData() {\r\n    this.variantData =\r\n      this.variantData ||\r\n      JSON.parse(this.querySelector('[type=\"application/json\"]').textContent);\r\n    return this.variantData;\r\n  }\r\n}\r\n\r\ncustomElements.define(\"variant-selects\", VariantSelects);\r\n\r\nclass VariantRadios extends VariantSelects {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  updateOptions() {\r\n    const fieldsets = Array.from(this.querySelectorAll(\"fieldset\"));\r\n    this.options = fieldsets.map((fieldset) => {\r\n      return Array.from(fieldset.querySelectorAll(\"input\")).find(\r\n        (radio) => radio.checked\r\n      ).value;\r\n    });\r\n  }\r\n}\r\n\r\ncustomElements.define(\"variant-radios\", VariantRadios);\r\n"],
  "mappings": "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",
  "names": []
}
